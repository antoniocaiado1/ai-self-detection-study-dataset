---
title: "Self-detection"
format: html
editor: visual
---

```{r}
library("tidyverse")
library("caret")
```

Load the data

```{r}
library("tidyverse")
x <- read_csv("AI_vs_Human_Data.csv", col_types = "ffffcfffffffffff")
x
```


```{r}
summary(x)
```


```{r}
x |> group_by(Source, Model, Paraphrased) |> count()
```

```{r}
eval <- function(x, generator, paraphrased, tester) {
  x |> filter(Source == "Human" | Model == generator & Paraphrased == paraphrased) -> x2
  cm <- confusionMatrix(reference = relevel(x2$Source, ref= "Human"), 
                        data = relevel(x2[[tester]], ref = "Human"), positive = "AI")
  data.frame(Generator = generator, Paraphrased = paraphrased,  Tester = tester,
             rbind(cm$overall), rbind(cm$byClass))
}

res <- rbind(
  eval(x, generator = "ChatGPT", paraphrased = "No", tester = "ChatGPT"),
  eval(x, generator = "ChatGPT", paraphrased = "No", tester = "zeroGPT"),
  eval(x, generator = "ChatGPT", paraphrased = "Yes", tester = "ChatGPT"),
  eval(x, generator = "ChatGPT", paraphrased = "Yes", tester = "zeroGPT"),
  
  eval(x, generator = "Bard", paraphrased = "No", tester = "Bard"),
  eval(x, generator = "Bard", paraphrased = "No", tester = "zeroGPT"),
  eval(x, generator = "Bard", paraphrased = "Yes", tester = "Bard"),
  eval(x, generator = "Bard", paraphrased = "Yes", tester = "zeroGPT"),
  
  eval(x, generator = "Claude", paraphrased = "No", tester = "Claude"),
  eval(x, generator = "Claude", paraphrased = "No", tester = "zeroGPT"),
  eval(x, generator = "Claude", paraphrased = "Yes", tester = "Claude"),
  eval(x, generator = "Claude", paraphrased = "Yes", tester = "zeroGPT")
)

res
```

```{r}
res |> mutate(Tester = ifelse(Tester != "zeroGPT", "Self-Detection", "zeroGPT")) -> res 
ggplot(res |> filter(Paraphrased == "No"), mapping = aes(x=Generator, y=Accuracy, fill = Tester)) +
    geom_bar(stat="identity", position = "dodge") +
    geom_errorbar(aes(ymin=AccuracyLower, ymax=AccuracyUpper), width = .2, position = position_dodge(.9))
```

```{r}
ggplot(res |> filter(Paraphrased == "Yes"), mapping = aes(x=Generator, y=Accuracy, fill = Tester)) +
    geom_bar(stat="identity", position = "dodge") +
    geom_errorbar(aes(ymin=AccuracyLower, ymax=AccuracyUpper), width = .2, position = position_dodge(.9))
```